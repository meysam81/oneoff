---
import Container from '../ui/Container.astro';
import Button from '../ui/Button.astro';
import Icon from '../icons/index.astro';

const navigation = [
  { name: 'Features', href: '#features' },
  { name: 'How it Works', href: '#how-it-works' },
  { name: 'Comparison', href: '#comparison' },
  { name: 'Catalog', href: '/catalog' },
];
---

<header class="fixed top-0 left-0 right-0 z-50 transition-all duration-300" id="site-header">
  <div class="absolute inset-0 bg-bg-primary/80 backdrop-blur-md border-b border-transparent transition-all duration-300" id="header-bg"></div>

  <Container size="xl" class="relative">
    <nav class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-2 text-fg-primary hover:text-accent-primary transition-colors">
        <Icon name="clock" size={24} class="text-accent-primary" />
        <span class="font-display font-semibold text-lg">OneOff</span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center gap-8">
        {navigation.map(item => (
          <a
            href={item.href}
            class="text-fg-secondary hover:text-fg-primary text-sm font-medium transition-colors"
          >
            {item.name}
          </a>
        ))}
      </div>

      <!-- Desktop CTA -->
      <div class="hidden md:flex items-center gap-4">
        <a
          href="https://github.com/meysam81/oneoff"
          target="_blank"
          rel="noopener noreferrer"
          class="text-fg-muted hover:text-fg-primary transition-colors"
          title="GitHub"
        >
          <Icon name="github" size={20} />
        </a>
        <Button href="#installation" size="sm">
          Download
        </Button>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-btn"
        class="md:hidden p-2 text-fg-muted hover:text-fg-primary transition-colors"
        aria-label="Toggle menu"
      >
        <Icon name="menu" size={24} id="menu-icon" />
        <Icon name="x" size={24} id="close-icon" class="hidden" />
      </button>
    </nav>
  </Container>

  <!-- Mobile Navigation -->
  <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 right-0 bg-bg-secondary border-b border-border-subtle">
    <Container size="xl">
      <div class="py-4 space-y-2">
        {navigation.map(item => (
          <a
            href={item.href}
            class="block px-4 py-2 text-fg-secondary hover:text-fg-primary hover:bg-bg-tertiary rounded-lg text-sm transition-colors"
          >
            {item.name}
          </a>
        ))}
        <div class="pt-4 mt-4 border-t border-border-subtle">
          <Button href="#installation" size="sm" class="w-full">
            Download
          </Button>
        </div>
      </div>
    </Container>
  </div>
</header>

<script>
  // Header scroll effect
  const header = document.getElementById('site-header');
  const headerBg = document.getElementById('header-bg');

  function updateHeader() {
    if (window.scrollY > 50) {
      headerBg?.classList.add('border-border-subtle');
      headerBg?.classList.remove('border-transparent');
    } else {
      headerBg?.classList.remove('border-border-subtle');
      headerBg?.classList.add('border-transparent');
    }
  }

  window.addEventListener('scroll', updateHeader);
  updateHeader();

  // Mobile menu toggle
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  menuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');
  });

  // Close mobile menu on link click
  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
      menuIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
    });
  });
</script>
